# Troubleshooting Guide

## Common Issues and Solutions

### Issue 1: Missing Dependencies ✅ FIXED
**Error:** `ModuleNotFoundError: No module named 'pandas'`

**Solution:**
```bash
pip install -r requirements.txt
```

### Issue 2: Unicode Encoding Error ✅ FIXED
**Error:** `UnicodeEncodeError: 'charmap' codec can't encode character`

**Solution:** Fixed in main.py - removed emojis and added UTF-8 encoding support.

### Issue 3: Missing Data Files ⚠️ NEEDS ATTENTION
**Error:** `FileNotFoundError: [WinError 3] The system cannot find the path specified: '/kaggle/input/nq2023/data'`

**Problem:** The `get_feature.py` file has hardcoded paths that point to Kaggle directories that don't exist on your system.

**Solution:** You need to:

1. **Update paths in `market_test/preproces/get_feature.py`:**

   Replace hardcoded paths (around lines 179, 197, 199, 209, 246, 250, 260) with relative paths:

   ```python
   # OLD (line 179):
   folder_path = '/kaggle/input/nq2023/data'
   
   # NEW:
   import os
   # Get project root (two levels up from this file)
   project_root = os.path.dirname(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))
   folder_path = os.path.join(project_root, 'data')
   ```

   ```python
   # OLD (line 197):
   df_BTC = pd.read_parquet('/kaggle/input/nq2023/data/Crypto/BTCUSDT').reset_index()
   
   # NEW:
   df_BTC = pd.read_parquet(os.path.join(folder_path, 'Crypto', 'BTCUSDT')).reset_index()
   ```

   ```python
   # OLD (line 199):
   df_Label = pd.read_parquet('/kaggle/input/nq2023/data/Label/LABEL_BTCUSDT').reset_index()
   
   # NEW:
   df_Label = pd.read_parquet(os.path.join(folder_path, 'Label', 'LABEL_BTCUSDT')).reset_index()
   ```

   ```python
   # OLD (line 209):
   df_SPY = pd.read_parquet('/kaggle/input/nq2023/data/Stocks/SPY').reset_index()
   
   # NEW:
   df_SPY = pd.read_parquet(os.path.join(folder_path, 'Stocks', 'SPY')).reset_index()
   ```

   ```python
   # OLD (line 246):
   df_final_notLabel.to_csv('/kaggle/working/realtime_feature.csv')
   
   # NEW:
   output_path = os.path.join(os.path.dirname(os.path.dirname(os.path.abspath(__file__))), 'realtimeData', 'realtime_feature.csv')
   df_final_notLabel.to_csv(output_path)
   ```

2. **Download data files first:**
   
   You need to run the data crawling script to download the required data:
   ```bash
   cd market_test
   python crawlAsubmit/crawling.py
   ```
   
   This will create a `data/` directory in the project root with the required files.

### Issue 4: Missing .env File ⚠️ NEEDS ATTENTION
**Error:** API key errors when trying to download data

**Solution:** Create a `.env` file in the project root:
```env
API_KEY=your_api_key_here
NESTQUANT_API_ENDPOINT=https://api-dev.nestquant.com
```

### Issue 5: Missing realtime_feature.csv
**Error:** `Warning: Feature file not found at ...`

**Solution:** This file is generated by the preprocessing step. You need to:
1. First, download data using the crawling script
2. Then run the main script, which will call `get_and_update_feature()` to generate this file

## Quick Fix Checklist

- [x] Install dependencies: `pip install -r requirements.txt`
- [x] Fix Unicode encoding issues (done in main.py)
- [ ] Create `.env` file with API key
- [ ] Update hardcoded paths in `get_feature.py`
- [ ] Download data files using crawling script
- [ ] Run main.py

## Step-by-Step Fix

1. **Create .env file:**
   ```bash
   # In project root
   echo API_KEY=your_api_key > .env
   echo NESTQUANT_API_ENDPOINT=https://api-dev.nestquant.com >> .env
   ```

2. **Update get_feature.py paths** (see Issue 3 above)

3. **Download data:**
   ```bash
   cd market_test
   python crawlAsubmit/crawling.py
   ```

4. **Run main script:**
   ```bash
   cd market_test
   python main/main.py
   ```

## Alternative: Use Existing Data

If you already have data files in a different location:

1. Create a `data/` directory in the project root
2. Organize your data as:
   ```
   data/
   ├── Crypto/
   │   └── BTCUSDT/
   ├── Stocks/
   │   └── SPY/
   ├── FX/
   ├── FRED/
   └── Label/
       └── LABEL_BTCUSDT/
   ```
3. Update paths in `get_feature.py` to point to your data directory

